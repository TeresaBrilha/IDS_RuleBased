[
  {
    "name": "detect_syn_flood",
    "priority": 1,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "syn_packet_count",
          "operatorValue": "greaterThanInclusive",
          "value": 1000
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "SYN flood detected!"
        }
      }
    ]
  },
  {
    "name": "Port Scan Detection Rule",
    "priority": 2,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "protocol",
          "operatorValue": "equal",
          "value": "tcp"
        },
        {
          "name": "destination_port_count",
          "operatorValue": "greaterThanInclusive",
          "value": 10
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "Port scan detected!"
        }
      }
    ]
  },
  {
    "name": "DoS Attack Detection Rule - High Rate of Source IP Changes",
    "priority": 3,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "protocol",
          "operatorValue": "equal",
          "value": "tcp"
        },
        {
          "name": "source_ip_count",
          "operatorValue": "greaterThanInclusive",
          "value": 100
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "DoS attack detected - high rate of source IP changes!"
        }
      }
    ]
  },
  {
    "name": "DoS Attack Detection Rule - High Rate of Requests to Single IP",
    "priority": 4,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "protocol",
          "operatorValue": "equal",
          "value": "tcp"
        },
        {
          "name": "destination",
          "operatorValue": "equal",
          "value": "10.0.0.1"
        },
        {
          "name": "request_count",
          "operatorValue": "greaterThanInclusive",
          "value": 1000
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "DoS attack detected - high rate of requests to single IP!"
        }
      }
    ]
  },
  {
    "name": "Mobile Device Detection Rule - User Agent",
    "priority": 5,
    "condition": {
      "logicalOperator": "any",
      "facts": [
        {
          "name": "user_agent",
          "operatorValue": "contains",
          "value": "Mobile"
        },
        {
          "name": "user_agent",
          "operatorValue": "contains",
          "value": "Android"
        },
        {
          "name": "user_agent",
          "operatorValue": "contains",
          "value": "iPhone"
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "Packet detected from mobile device!"
        }
      }
    ]
  },
  {
    "name": "SQL Injection Detection Rule - Multiple Conditions",
    "priority": 6,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "http_request_uri",
          "operatorValue": "contains",
          "value": "';"
        },
        {
          "name": "http_request_uri",
          "operatorValue": "contains",
          "value": "--"
        },
        {
          "name": "http_request_uri",
          "operatorValue": "matches",
          "value": ".*/\\*.*\\*/"
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "SQL injection attack detected!"
        }
      }
    ]
  },
  {
    "name": "RAT Detection Rule - Multiple Conditions",
    "priority": 7,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "destination_port",
          "operatorValue": "in",
          "value": [ 80, 443, 3389 ]
        },
        {
          "name": "packet_size",
          "operatorValue": "greaterThanInclusive",
          "value": 1000
        },
        {
          "name": "packet_payload",
          "operatorValue": "contains",
          "value": "cmd.exe"
        },
        {
          "name": "packet_payload",
          "operatorValue": "matches",
          "value": ".*c:\\\\windows\\\\system32\\\\*.exe"
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "RAT detected!"
        }
      }
    ]
  },
  {
    "name": "Illegal Destination IP",
    "priority": 8,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "destination",
          "operatorValue": "equal",
          "value": "10.0.1.95"
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "Illegal Destination IP Detected! 10.0.0.95"
        }
      }
    ]
  },
  {
    "name": "HTTP Packet Detection Rule",
    "priority": 9,
    "condition": {
      "logicalOperator": "all",
      "facts": [
        {
          "name": "protocol",
          "operatorValue": "in",
          "value": ["udp", "tcp"]
        },
        {
          "name": "destination_port",
          "operatorValue": "in",
          "value": [ 80 ]
        },
        {
          "name": "packet_size",
          "operatorValue": "lessThanInclusive",
          "value": 2048
        }
      ]
    },
    "actions": [
      {
        "name": "alert",
        "parameters": {
          "message": "HTTP packet detected!"
        }
      }
    ]
  }
]

